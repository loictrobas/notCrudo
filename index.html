<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Batalla de Nombres</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      margin: 60px auto;
      max-width: 600px;
      background: #eee;
    }
    h1 {
      font-size: 2rem;
      margin-bottom: 20px;
    }
    p {
      font-size: 1.1rem;
      margin-bottom: 40px;
      color: #444;
    }
    button {
      padding: 15px 30px;
      margin: 10px;
      font-size: 1.2rem;
      cursor: pointer;
      border: none;
      border-radius: 8px;
      background-color: #333;
      color: white;
      transition: background-color 0.3s;
    }
    button:hover {
      background-color: #555;
    }
    ul {
      text-align: left;
      margin-top: 20px;
      padding-left: 0;
      list-style: none;
    }
    li {
      margin: 5px 0;
    }
  </style>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
</head>
<body>
  <h1>Batalla de Nombres 游볡</h1>
  <p>Vas a ver dos nombres enfrentados. Eleg칤 cu치l te gusta m치s. El perdedor queda eliminado. El proceso contin칰a hasta que quede un solo nombre... y ese ser치 tu favorito 游끥</p>

  <button id="option1"></button>
  <button id="option2"></button>

  <div id="resultado" style="display:none;"></div>

  <script>
    const names = [
      "칍xido", "Pecado", "Guapo", "P칤caro", "Virgo", "Vizio", "Ad치n y Evoo",
      "Satin", "Ingrato", "Maldito", "Ambar", "Capricho", "Cautivo",
      "Desliz", "Goce", "Chorro", "Bend칤to"
    ];

    const firebaseConfig = {
      apiKey: "AIzaSyCiexyUYac9E8UMcIm4aLTw9IMuEO3ukxE",
      authDomain: "notcrudo.firebaseapp.com",
      projectId: "notcrudo",
      storageBucket: "notcrudo.firebasestorage.app",
      messagingSenderId: "59156363110",
      appId: "1:59156363110:web:0ea9b6f22815d09d857aa7",
      measurementId: "G-F5MZ01HF1R"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    let round = shuffleArray([...names]);

    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function showNextPair() {
      if (round.length === 1) {
        const winner = round[0];
        db.collection("votos").doc(winner).get().then(doc => {
          if (doc.exists) {
            db.collection("votos").doc(winner).update({ total: doc.data().total + 1 });
          } else {
            db.collection("votos").doc(winner).set({ total: 1 });
          }
        });

        document.querySelector("h1").textContent = `游끥 Tu nombre ganador: ${winner}`;
        document.querySelector("p").style.display = "none";
        document.getElementById("option1").style.display = "none";
        document.getElementById("option2").style.display = "none";

        const resultado = document.getElementById("resultado");
        resultado.style.display = "block";
        resultado.innerHTML = "<p>Cargando ranking...</p>";

        db.collection("votos").orderBy("total", "desc").get().then(snapshot => {
          let html = "<h2>Ranking global:</h2><ul>";
          snapshot.forEach(doc => {
            html += `<li><strong>${doc.id}</strong>: ${doc.data().total} voto(s)</li>`;
          });
          html += "</ul><button onclick='reiniciar()'>Volver a jugar</button>";
          resultado.innerHTML = html;
        });

        return;
      }

      const btn1 = document.getElementById("option1");
      const btn2 = document.getElementById("option2");
      btn1.textContent = round[0];
      btn2.textContent = round[1];

      btn1.onclick = () => vote(round[0], round[1]);
      btn2.onclick = () => vote(round[1], round[0]);
    }

    function vote(winner, loser) {
      round = round.filter(name => name !== loser);
      showNextPair();
    }

    function reiniciar() {
      round = shuffleArray([...names]);
      document.querySelector("h1").textContent = "Batalla de Nombres 游볡";
      document.querySelector("p").style.display = "block";
      document.getElementById("option1").style.display = "inline-block";
      document.getElementById("option2").style.display = "inline-block";
      document.getElementById("resultado").style.display = "none";
      showNextPair();
    }

    showNextPair();
  </script>
</body>
</html>